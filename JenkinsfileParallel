pipeline {
    agent {
        node {
            label 'master'
        }
    }
    triggers { upstream(upstreamProjects: 'jenkins_pipeline_example', threshold: hudson.model.Result.SUCCESS) }
    options {
        disableConcurrentBuilds()
        timeout(time: 10, unit: 'SECONDS')
    }
    parameters {
        booleanParam(name: 'bool', defaultValue: false, description: '')
        string(name: 'string', defaultValue: 'hello', description: '')
        choice(name: 'choice', choices: ['one','two','three'], description: '')
        password(name: 'password', defaultValue: 'SECRET', description: '')
        text(name: 'text', defaultValue: 'One\nTwo\nThree\n', description: '')
    }
    stages {
        stage("One") {
            options {
                timestamps()
            }
            steps {
                sleep 1
                echo 'Stage 1'

                echo "Paramaters: ${params.bool} ${param.string} ${param.choice} ${param.password} ${param.text}"
            }
        }
        stage("Two") {
            options {
                timeout(time: 2, unit: 'SECONDS')
            }
            steps {
                sleep 3
                echo 'Stage 2'
            }
        }
        stage("Three") {
            options {
                retry(2)
            }
            steps {
                echo 'Stage 3'
                sh 'false'
            }
        }
    }
}
