pipeline {
    agent any
    stages {
        stage("Downstream") {
            steps {
                echo "${BUILD_TAG}"
                // need to manual configure "Permission to Copy Artifact" in the upstream job
                copyArtifacts projectName: 'upstream', selector: upstream()
                sh "cat upstream_artifact.txt"

                // use S3 publisher plugin
                s3CopyArtifact buildSelector: lastCompleted(), excludeFilter: '', filter: 'upstream_artifact_aws.txt', flatten: false, optional: false, projectName: 'upstream', target: ''
                sh "cat upstream_artifact_aws.txt"
            }
        }
    }
}
